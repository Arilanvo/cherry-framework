!function(e,t){"use strict";t.utilites.namespace("ui_elements.repeater"),t.ui_elements.repeater={repeaterContainerClass:".cherry-ui-repeater-container",repeaterListClass:".cherry-ui-repeater-list",repeaterItemClass:".cherry-ui-repeater-item",repeaterItemHandleClass:".cherry-ui-repeater-actions-box",repeaterTitleClass:".cherry-ui-repeater-title",addItemButtonClass:".cherry-ui-repeater-add",removeItemButtonClass:".cherry-ui-repeater-remove",toggleItemButtonClass:".cherry-ui-repeater-toggle",minItemClass:"cherry-ui-repeater-min",sortablePlaceholderClass:"sortable-placeholder",init:function(){e(document).on("ready",this.addEvents.bind(this))},addEvents:function(){e("body").on("click",this.addItemButtonClass,{self:this},this.addItem).on("click",this.removeItemButtonClass,{self:this},this.removeItem).on("click",this.toggleItemButtonClass,{self:this},this.toggleItem).on("change",this.repeaterListClass+" input, "+this.repeaterListClass+" textarea, "+this.repeaterListClass+" select",{self:this},this.changeWrapperLable).on("sortable-init",{self:this},this.sortableItem),e(window).on("cherry-ui-elements-init",{self:this},this.sortableItem),this.triggers()},triggers:function(t){return e("body").trigger("sortable-init"),t&&e(window).trigger("cherry-ui-elements-init",{target:t}),this},addItem:function(t){var s=t.data.self,a=e(this).prev(s.repeaterListClass),r=a.data("index"),i=a.data("name"),l=wp.template(i),n=a.data("widget-id"),o={index:r};n&&(o.widgetId=n),a.append(l(o)),r++,a.data("index",r),s.triggers(e(s.repeaterItemClass,a)).stopDefaultEvent()},removeItem:function(t){var s=t.data.self,a=e(this).closest(s.repeaterListClass);s.applayChenges(a),e(this).closest(s.repeaterItemClass).remove(),s.triggers().stopDefaultEvent()},toggleItem:function(t){var s=t.data.self,a=e(this).closest(s.repeaterItemClass);a.toggleClass(s.minItemClass),s.stopDefaultEvent()},sortableItem:function(t){var s=t.data.self,a=e(s.repeaterListClass);a.each(function(t,a){var r=e(a),i=e(a).data("sortable-init");r.sortable(i?"refresh":{items:s.repeaterItemClass,handle:s.repeaterItemHandleClass,cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,helper:"clone",opacity:.65,placeholder:s.sortablePlaceholderClass,create:function(){r.data("sortable-init",!0)},update:function(t){var a=e(t.target);s.applayChenges(a)}})})},changeWrapperLable:function(t){var s=t.data.self,a=e(s.repeaterListClass),r=a.data("title-field"),i=e(this);if(r&&i.closest("."+r+"-wrap")[0]){var l=i.val(),n=i.closest(s.repeaterItemClass);e(s.repeaterTitleClass,n).html(l)}s.stopDefaultEvent()},applayChenges:function(t){if(void 0!==wp.customize){var s=e("input[name]:first, select[name]:first",t);s.change()}return this},stopDefaultEvent:function(){return event.preventDefault(),event.stopImmediatePropagation(),event.stopPropagation(),this}},t.ui_elements.repeater.init()}(jQuery,window.CherryJsCore);