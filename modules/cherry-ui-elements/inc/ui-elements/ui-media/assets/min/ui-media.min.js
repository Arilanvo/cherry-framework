!function(a,b){"use strict";b.utilites.namespace("ui_elements.media"),b.ui_elements.media={init:function(a){var c=this;b.status.document_ready?c.render(a):b.variable.$document.on("ready",c.render(a))},render:function(c){a(document).on("click",".upload-button",function(c){var e=a(c.currentTarget).parents(".cherry-ui-media-wrap"),f=a(".cherry-upload-input",e),g=a(c.currentTarget).data("title"),h=a(c.currentTarget).data("multi-upload"),i=a(c.currentTarget).data("library-type");return b.ui_elements.media.img_holder=a(".cherry-upload-preview",e),void 0!==b.ui_elements.media.uploader?void b.ui_elements.media.uploader.open():(b.ui_elements.media.uploader=wp.media.frames.file_frame=wp.media({title:g,button:{text:g},multiple:h,library:{type:i}}),b.ui_elements.media.uploader.on("select",function(){var c=b.ui_elements.media.uploader.state().get("selection").toJSON(),e=0,g="",i="",j="";for(h&&(g=f.val(),j=",",i=a(".cherry-all-images-wrap",b.ui_elements.media.img_holder).html());c[e];){var k=c[e],l=k.id,m=k.mime,n="",o="";switch(m){case"image/jpeg":case"image/png":case"image/gif":void 0!==k.sizes&&(n=k.sizes.thumbnail?k.sizes.thumbnail.url:k.sizes.full.url),o='<img  src="'+n+'" alt="" data-img-attr="'+l+'">';break;case"image/x-icon":o='<span class="dashicons dashicons-format-image"></span>';break;case"video/mpeg":case"video/mp4":case"video/quicktime":case"video/webm":case"video/ogg":o='<span class="dashicons dashicons-format-video"></span>';break;case"audio/mpeg":case"audio/wav":case"audio/ogg":o='<span class="dashicons dashicons-format-audio"></span>'}i+='<div class="cherry-image-wrap"><div class="inner"><div class="preview-holder"  data-id-attr="'+l+'"><div class="centered">'+o+'</div></div><a class="cherry-remove-image" href="#"><i class="dashicons dashicons-no"></i></a><span class="title">'+k.title+"</span></div></div>",g+=j+l,e++}f.val(g.replace(/(^,)/,"")).trigger("change"),console.log(b.ui_elements.media.img_holder),a(".cherry-all-images-wrap",b.ui_elements.media.img_holder).html(i),a(".cherry-remove-image").on("click",function(){return d(a(this)),!1})}).open(),!1)}),jQuery(".cherry-remove-image",c).on("click",function(){return d(jQuery(this)),!1});var d=function(a){var b=a.parents(".cherry-ui-media-wrap"),c=jQuery(".cherry-upload-input",b),d=a.parent().parent(".cherry-image-wrap"),e=jQuery(".preview-holder",d).data("id-attr"),f=c.attr("value"),g=new RegExp(""+e+"(,*)","i");f=f.replace(g,""),f=f.replace(/(,$)/,""),c.attr({value:f}).trigger("change"),d.remove()};jQuery(".cherry-all-images-wrap",c).sortable({items:"div.cherry-image-wrap",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,helper:"clone",opacity:.65,placeholder:"cherry-media-thumb-sortable-placeholder",update:function(){var a="";jQuery(".cherry-image-wrap",this).each(function(){var b=jQuery(".preview-holder",this).data("id-attr");a=a+b+","}),a=a.substr(0,a.lastIndexOf(",")),jQuery(this).parent().siblings(".cherry-element-wrap").find("input.cherry-upload-input").val(a).trigger("change")}})}},a(window).on("cherry-ui-elements-init",function(a,c){b.ui_elements.media.init(c.target)})}(jQuery,window.CherryJsCore);