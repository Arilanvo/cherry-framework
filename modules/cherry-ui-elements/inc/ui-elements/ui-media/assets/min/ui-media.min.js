!function(e,a){"use strict";a.utilites.namespace("ui_elements.media"),a.ui_elements.media={init:function(e){var r=this;a.status.document_ready?r.render(e):a.variable.$document.on("ready",r.render(e))},render:function(r){e(document).on("click",".upload-button",function(r){var t=e(r.currentTarget).parents(".cherry-ui-media-wrap"),s=e(".cherry-upload-input",t),n=e(r.currentTarget).data("title"),c=e(r.currentTarget).data("multi-upload"),l=e(r.currentTarget).data("library-type");return a.ui_elements.media.img_holder=e(".cherry-upload-preview",t),void 0!==a.ui_elements.media.uploader?void a.ui_elements.media.uploader.open():(a.ui_elements.media.uploader=wp.media.frames.file_frame=wp.media({title:n,button:{text:n},multiple:c,library:{type:l}}),a.ui_elements.media.uploader.on("select",function(){var r=a.ui_elements.media.uploader.state().get("selection").toJSON(),t=0,n="",l="",d="";for(c&&(n=s.val(),d=",",l=e(".cherry-all-images-wrap",a.ui_elements.media.img_holder).html());r[t];){var o=r[t],u=o.id,m=o.mime,p="",h="";switch(m){case"image/jpeg":case"image/png":case"image/gif":void 0!==o.sizes&&(p=o.sizes.thumbnail?o.sizes.thumbnail.url:o.sizes.full.url),h='<img  src="'+p+'" alt="" data-img-attr="'+u+'">';break;case"image/x-icon":h='<span class="dashicons dashicons-format-image"></span>';break;case"video/mpeg":case"video/mp4":case"video/quicktime":case"video/webm":case"video/ogg":h='<span class="dashicons dashicons-format-video"></span>';break;case"audio/mpeg":case"audio/wav":case"audio/ogg":h='<span class="dashicons dashicons-format-audio"></span>'}l+='<div class="cherry-image-wrap"><div class="inner"><div class="preview-holder"  data-id-attr="'+u+'"><div class="centered">'+h+'</div></div><a class="cherry-remove-image" href="#"><i class="dashicons dashicons-no"></i></a><span class="title">'+o.title+"</span></div></div>",n+=d+u,t++}s.val(n.replace(/(^,)/,"")).trigger("change"),e(".cherry-all-images-wrap",a.ui_elements.media.img_holder).html(l),e(".cherry-remove-image").on("click",function(){return i(e(this)),!1})}).open(),!1)}),jQuery(".cherry-remove-image",r).on("click",function(){return i(jQuery(this)),!1});var i=function(e){var a=e.parents(".cherry-ui-media-wrap"),r=jQuery(".cherry-upload-input",a),i=e.parent().parent(".cherry-image-wrap"),t=jQuery(".preview-holder",i).data("id-attr"),s=r.attr("value"),n=new RegExp(""+t+"(,*)","i");s=s.replace(n,""),s=s.replace(/(,$)/,""),r.attr({value:s}).trigger("change"),i.remove()};jQuery(".cherry-all-images-wrap",r).sortable({items:"div.cherry-image-wrap",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,helper:"clone",opacity:.65,placeholder:"cherry-media-thumb-sortable-placeholder",update:function(){var e="";jQuery(".cherry-image-wrap",this).each(function(){var a=jQuery(".preview-holder",this).data("id-attr");e=e+a+","}),e=e.substr(0,e.lastIndexOf(",")),jQuery(this).parent().siblings(".cherry-element-wrap").find("input.cherry-upload-input").val(e).trigger("change")}})}},e(window).on("cherry-ui-elements-init",function(e,r){a.ui_elements.media.init(r.target)})}(jQuery,window.CherryJsCore);